# 도커 허브에 있는 노드 이미지를 가져온다.
FROM node 

# 이게 실행기준이 되는 디렉토리다.
WORKDIR /app

# 도커에게 로컬머신에 있는 어떠한 파일이 이미지에 들어가야 하는 지 알려준다.
# 첫 번째 경로는 컨테이너의 외부(이미지로 복사되어야 할 파일들이 있는 곳) 즉, Dockerfile을 제외한 현재의 프로젝트 폴더 전체를 의미한다.
# 이 프로젝트의 모든 폴더, 하위 폴더 및 파일을 모두 복사해야 한다고 도커에게 알리는 것 
# 두 번째는 파일을 저장해여 헌는 이미지 내부의 경로다.
# 도커 자체 내부 파일 시스템인데, 도커 컨테이너 내부에 숨겨져 있으며, 실제로 루트폴더를 사용하기 보다는 전적으로 사용자가 선택한 서브 폴더를 사용하는 것을 권장
# 즉 컨테이너 내부에 있는 app 폴더에 복사를 한다는 말이다.
COPY . /app

# 이 작업은 디폴트로 도커 컨테이너 및 이미지의 작업 디렉토리에서 실행된다.
# 그 작업 디렉토리는 컨테이너 파일 시스템의 루프 폴더이다. 
# app 폴더 내에서 실행하고 싶다면, 도커에게 모든 명령이 그 폴더에서 실행되어야 한다고 알려주는 방법은 WORKDIR 설정이다.
RUN npm install

# 언제나 컨테이너가 실행될 때, 로컬 시스템에 특정 포트를 노출하고 싶다는 것을 도커에게 알리는 EXPOSE 명령을 반드시 추가해야한다.
EXPOSE 80

# 이미지를 기반으로 컨테이너를 시작하는 경우에만 서버를 시작하고 싶다면, RUN이 아닌 CMD명령어를 이용한다.
CMD ["node", "server.js"]